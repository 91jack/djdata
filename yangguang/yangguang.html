<!doctype html>
<html class="no-js">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>盘州市亦资街道阳光政务服务数据平台</title>
		<link rel="stylesheet" type="text/css" href="static/css/bigdata.css" />
		<link rel="stylesheet" type="text/css" href="static/layer/theme/default/layer.css" />
	</head>
	<body id="bigdata">
		<!--顶部-->
		<div class="header">
			<div class="header-border-top"></div>
			<div class="container">
				<div class="date"></div>
				<div class="header-title">盘州市亦资街道阳光政务服务数据平台</div>
				<a href="./index.html" class="gohome"></a>
			</div>
			<div class="header-border-bottom"></div>
		</div>

		<!--内容区域-->
		<div class="bigdata-content">
			<div class="container">
				<div class="section1">
					<div class="section-item">
						<div class="section-item-title">
							<h2>阳光政务实时服务动态</h2>
							<p>Real time service dynamics </p>
						</div>
						<div class="section-item-content">
							<div id="s1list">
								<ul class="section-item-list" id="cygj"></ul>
							</div>
						</div>
					</div>

					<div class="section-item">
						<div class="section-item-title">
							<h2>政务服务类型</h2>
							<p>Types of government services</p>
						</div>
						<div class="section-item-content barchart">
							<!--柱状图-->
							<div id="barchart"></div>
						</div>
					</div>
				</div>

				<div class="section2">
					<!--顶部数据展示-->
					<div class="section2-top-data">
						<div class="item-level">
							<div class="item-level-one">
								<span>政务服务量</span>
								<span><ol class="dangyuan1"></ol><em>件</em></span>
							</div>
						</div>

						<div class="item-level">
							<div class="item-level-one">
								<span>已办结量</span>
								<span><ol class="dangyuan2"></ol><em>件</em></span>
							</div>
						</div>

						<div class="item-level">
							<div class="item-level-one">
								<span>未办结量</span>
								<span><ol class="dangyuan3"></ol><em>件</em></span>
							</div>
						</div>
					</div>

					<!--贵州地图-->
					<div class="section2-chart">
						<div class="map-list">
							<a href="javascript:;"><i></i>亦资居委会党支部</a>
							<a href="javascript:;"><i></i>亦资街道党工委</a>
						</div>
						<div class="map-box">
							<div class="map" id="mapchart"></div>
							<div class="map" id="map" style="display: none;">
								<div class="map-wrap">
									<img src="static/mapimg/0.png" />
								</div>
								<div class="map-num">
									<a href="javascript:;" style="left:1.8rem;top:15rem;" data-index="1">1</a>
									<a href="javascript:;" style="left:1.65rem;top:19.15rem;" data-index="2">2</a>
									<a href="javascript:;" style="left:1.6rem;top:24.25rem;" data-index="3">3</a>
									<a href="javascript:;" style="left:6.95rem;top:16.65rem;" data-index="4">4</a>
									<a href="javascript:;" style="left:5.5rem;top:23.6rem;" data-index="5">5</a>
									<a href="javascript:;" style="left:8rem;top:24.6rem;" data-index="6">6</a>

									<a href="javascript:;" style="left:11rem;top:23.45rem;" data-index="7">7</a>

									<a href="javascript:;" style="left:9.15rem;top:19rem;" data-index="8">8</a>
									<a href="javascript:;" style="left:7.95rem;top:21.4rem;" data-index="9">9</a>
									<a href="javascript:;" style="left:7.8rem;top:10.7rem;" data-index="10">10</a>

									<a href="javascript:;" style="left:14.45rem;top:21.25rem;" data-index="11">11</a>
									<a href="javascript:;" style="left:16.15rem;top:15.15rem;" data-index="12">12</a>
									<a href="javascript:;" style="left:17rem;top:20.4rem;" data-index="13">13</a>
									<a href="javascript:;" style="left:17rem;top:16rem;" data-index="13">13</a>
									<a href="javascript:;" style="left:18.55rem;top:20rem;" data-index="14">14</a>
									<a href="javascript:;" style="left:14.2rem;top:17rem;" data-index="14">14</a>

									<a href="javascript:;" style="left:12.5rem;top:13.5rem;" data-index="15">15</a>
									<a href="javascript:;" style="left:16.8rem;top:11.4rem;" data-index="16">16</a>
									<a href="javascript:;" style="left:14.65rem;top:8.3rem;" data-index="17">17</a>
									<a href="javascript:;" style="left:16rem;top:1.35rem;" data-index="18">18</a>
									<a href="javascript:;" style="left:13.8rem;top:3.95rem;" data-index="19">19</a>
									<a href="javascript:;" style="left:16.8rem;top:13.4rem;" data-index="20">20</a>
								</div>
							</div>
						</div>
					</div>
				</div>

				<div class="section3">
					<div class="section-item">
						<div class="section-item-title">
							<h2>网格政务服务动态</h2>
							<p>Real time dynamic</p>
						</div>
						<div class="section-item-content" id="section3Ul">
							<div class="section3-tab-btn">
								<div class="wrapper wrapper04" id="sass">
								    <div class="scroller">
								        <ul class="clearfix" id="nav"></ul>
								    </div>
								</div>
							</div>

							<div class="section3-tab-content">
								<div id="s3list1"></div>
								<!--<ul class="section3-top-list"></ul>-->
							</div>
						</div>
					</div>

					<div class="section-item  clearfix">
						<div class="section-item-title">
							<h2>阳光政务实时互动动态</h2>
							<p>Real time dynamic</p>
						</div>
						<div class="section-item-content s3">
							<p><span>用户名</span><span>时间</span></p>
							<div id="s3list2">
								<ul class="section-item-list section3-list"></ul>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="footerchart">
			<div class="container">
				<div class="section-item footer-left-item">
					<div class="section-item-title">
						<h2>亦资街道基层党建人力分布图</h2>
						<p>Human distribution map </p>
					</div>
					<div class="piechart-wrap">
						<div class="piechart">
							<div id="piechart1" style="width:13rem;height:12rem"></div>
							<p>流动人口</p>
						</div>
						<div class="piechart">
							<div id="piechart2" style="width:13rem;height:12rem"></div>
							<p>流动党员</p>
						</div>
						<div class="piechart">
							<div id="piechart3" style="width:13rem;height:12rem"></div>
							<p>店铺</p>
						</div>
						<div class="piechart">
							<div id="piechart4" style="width:13rem;height:12rem"></div>
							<p>政治面貌</p>
						</div>
						<div class="piechart">
							<div id="piechart5" style="width:13rem;height:12rem"></div>
							<p>困难人员</p>
						</div>

						<div class="piechart">
							<div id="piechart6" style="width:13rem;height:12rem"></div>
							<p>大学生</p>
						</div>

						<div class="piechart">
							<div id="piechart7" style="width:13rem;height:12rem"></div>
							<p>性别</p>
						</div>

						<div class="piechart">
							<div id="piechart8" style="width:13rem;height:12rem"></div>
							<p>就业</p>
						</div>
					</div>
				</div>

				<div class="section-item footer-right-item">
					<div class="section-item-title">
						<h2>智慧亦资服务量(月)</h2>
						<p>Amount of use </p>
					</div>
					<div id="linechart"></div>
				</div>
			</div>
		</div>

		<!--弹窗1-->
		<div class="popup popup1">
			<!--<div class="img-box">
				<img src="static/images/banner.png" />
			</div>
			<div class="content">
				<p>单位名称：1111111111111</p>
				<p>单位地址：1111111111111</p>
				<p>员工数量：1111111111111</p>
				<p>是否有党群组织：<span style="color: #1E9FFF;">是</span></p>
				<p>党组织介绍：1111111</p>
			</div>-->
		</div>

		<!--弹窗2-->
		<div class="popup popup2">
			<div class="img-box">
				<img src="static/images/banner.png" />
			</div>
			<div class="content">
				<p>学习主题：1111111111111</p>
				<p class="party clearfix">
					<span>党支部人数：110人</span>
					<span>流动党员人数：110人</span>
					<span>学习完成率：95%</span>
				</p>
				<div class="section-item clearfix">
					<h2>未学习</h2>
					<div class="section-body">
						<p>
							<span>战三</span>
							<span>战三</span>
							<span>战三</span>
							<span>战三</span>
							<span>战三</span>
							<span>战三</span>
						</p>
						<p>
							<span>战三</span>
							<span>战三</span>
							<span>战三</span>
							<span>战三</span>
							<span>战三</span>
							<span>战三</span>
						</p>
					</div>
				</div>
				<div class="section-item clearfix">
					<h2>已学习</h2>
					<div class="section-body">
						<p>
							<span>战三</span>
							<span>战三</span>
							<span>战三</span>
							<span>战三</span>
							<span>战三</span>
							<span>战三</span>
						</p>
						<p>
							<span>战三</span>
							<span>战三</span>
							<span>战三</span>
							<span>战三</span>
							<span>战三</span>
							<span>战三</span>
						</p>
					</div>
				</div>
			</div>
		</div>

<script src="static/js/jquery-1.11.0.min.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" src="https://cdn.bootcss.com/iScroll/5.2.0/iscroll.min.js"></script>
<script type="text/javascript" src="static/js/navbarscroll.js"></script>
<script src="static/js/common.js"></script>
<script src="static/js/scroll.js" type="text/javascript" charset="utf-8"></script>
<script src="static/js/echarts.min.js" type="text/javascript" charset="utf-8"></script>
<script src="static/layer/layer.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
// 地图切换
$('.map-list a').click(function() {
	var index = $(this).index();
	$('.map-box .map').eq(index).show().siblings().hide();
})

// 网格地图hover
$('.map-num a').each(function() {
	$(this).hover(function() {
		var index = $(this).attr('data-index');
		$('.map-wrap img').attr('src', 'static/mapimg/' + index + '.png');
	})
})
	
var host = 	'http://gzps.xnshequ.com/tongji_bigdata/'	
//1.实时服务动态
var cygjUrl = host +'online';

//2.党员服务量，流动党员服务量，党建联建
var t3Url = host +'number';

//3.支部学习实时动态
var sbdUrl = host +'sbd';

//4.服务类型
var jobcateUrl = host +'fuwutype';

//5.党建线上互动实时动态
var rtdynamicUrl = host +'rtdynamic';

//6.亦资街道基层党组织人力分布图
var gridUrl = host +'grid';

//7.智慧亦资服务量
var channelUrl = host +'channel';

//8.贵州区域地图
var mapUrl = host +'map';

//9.用户登录实时地图显示
var mpdynamicUrl = host +'mpdynamic';


/*数据渲染*/
//1.实时服务动态
ajaxData(cygjUrl,function(res){
	console.log(res)
	var str = ''
	for(var i = 0;i<res.data.length;i++){
		str += '<li cpid="'+res.data[i].id+'">'
			+'<span class="sort">'+(i+1)+'</span>'
			+'<span>'+res.data[i].quyu_name +'</span>'
			+'<span>'+res.data[i].sqr_name+'</span>'
			+'<span>'+res.data[i].leibie_name+'</span>'
			+'<span>'+res.data[i].sq_name+'</span>'
			+'</li>'
	}
	$('#cygj').html(str);
	for(var i = 0;i<3;i++){
		$('#cygj li').eq(i).children('.sort').css('background','#E58B26');
	}
	$('#cygj li').click(function(){
		console.log($(this).attr('cpid'))
		$.ajax({
			type:"get",
			url:"http://gzps.xnshequ.com/tongji_bigdata/company",
			data:{
				cp_id:$(this).attr('cpid')
			},
			success:function(res){
				console.log(res)
				var popStr = '';
				popStr +='<div class="img-box">'
					+'<img src="static/images/banner.png" />'
					+'</div>'
					+'<div class="content">'
						+'<p>单位名称：'+res.data.company_info.name+'</p>'
						+'<p>单位地址：'+res.data.company_info.pro_name + res.data.company_info.city_name + res.data.company_info.area_name + res.data.company_info.street_name + res.data.company_info.shequ_name + res.data.company_info.xiaoqu_name + res.data.company_info.loudong_name+'</p>'
						+'<p>员工数量：'+res.data.company_info.staff_num+'</p>'
						
						if(res.data.company_info.dangzuzhi == '1'){
							popStr +='<p>是否有党群组织：<span style="color: #1E9FFF;">是</span></p>'
						}else{
							popStr +='<p>是否有党群组织：<span style="color: #FF0017;">否</span></p>'
						}
						
						
						popStr +='<p>党组织介绍：'+res.data.dzjianjie.description+'</p>'
					+'</div>'
				
				$('.popup1').html(popStr);
				
				layer.open({
					type: 1,
					area: ['880px', '880px'],
					title: res.data.company_info.name,
					shade: 0.2,
					shadeClose: true, //点击遮罩关闭
					content: $('.popup1')
				});
			}
		});

	});
	
	// 非公党建单位-列表上下滚动
	$("#s1list").myScroll({
		speed:40, 
		rowHeight:40
	});
			
});

//2.政务服务量、已办结量、未办接量
ajaxData(t3Url,function(res){
	var oldNum1 = 11
	$('.dangyuan1').html(updateNum(oldNum1, res.data.fuwu_num));
	
	var oldNum2 = 11
	$('.dangyuan2').html(updateNum(oldNum2, res.data.ybj_num));
	
	var oldNum3 = 11
	$('.dangyuan3').html(updateNum(oldNum3, res.data.wbj_num));
});

//3.网格政务服务动态
ajaxData(sbdUrl,function(res){
	var str = ''
	for(var i = 0;i<res.data.length;i++){
		str +='<li><a href="javascript:void(0)">'+res.data[i].category_name+'</a></li>' 
	}
	$('#nav').html(str);

	$('.wrapper').navbarscroll();
	
	var listStr = '';
	for(var i = 0;i<res.data.length;i++){
		listStr +='<ul class="section3-top-list">'
		for(var j=0;j<res.data[i].articles.length;j++){
			listStr +='<li>'
			if(j<3){
				listStr +='<span class="sort" style="background:#E58B26">'+(j+1)+'</span>'
			}else{
				listStr +='<span class="sort">'+(j+1)+'</span>'
				
			}
			
			var title = ''
			if(res.data[i].articles[j].title.length>10){
				title = res.data[i].articles[j].title.substr(0,8)+'...'
				listStr +='<span class="theme">'+title+'</span>'
			}
			
			listStr +='<p><span>流动党员</span><em>'+res.data[i].articles[j].liudong_num+'人</em></p>'
			+'<p><span>辖区党员</span><em>'+res.data[i].articles[j].feiliudong_num+'人</em></p>'
			+'<p><span>完成率</span><em>'+res.data[i].articles[j].wancheng+'</em></p>'
		+'</li>'
		}
		listStr +='</ul>';
	}
	
	
	$('#s3list1').html(listStr);
	
	$('.scroller li a').eq(0).addClass('cur').parent().siblings().children('a').removeClass('cur');
	$('.section3-tab-content ul').eq(0).show().siblings().hide();
	$("#s3list1").myScroll({
		speed:40, 
		rowHeight:50
	});	
	
	

	var index = 0;
	var timer = null;
	timer = setInterval(function(){
		index++;
		//sectionUl(index);
		if(index >$('.scroller li a').length ){
			index = 0;
		}
		$('.scroller li a').eq(index).trigger("click");
		$('.scroller li a').eq(index).bind('click',function(){
			sectionUl(index)
		})
		
	},2000)
	
	$('#section3Ul').hover(function(){
		clearInterval(timer);
	},function(){
		timer;
	})
	
	
	$('.scroller li a').click(function(){
		var index = $(this).parent().index();
		sectionUl(index)
	})
	
	
});

function sectionUl(index){
	$('.scroller li a').eq(index).addClass('cur').parent().siblings().children('a').removeClass('cur');
	$('.section3-tab-content ul').eq(index).show().siblings().hide();
	
	
	
	// 弹窗2
	$('.section3-top-list li').on('click', function() {
		
		layer.open({
			type: 1,
			area: ['880px', '880px'],
			title: 'xxxx党组织部',
			shade: 0.2,
			shadeClose: true, //点击遮罩关闭
			content: $('.popup2')
		});
	});	
}

//4.政务服务展示
ajaxData(jobcateUrl,function(res){
	//console.log(res)
	var xData = [];
	var barData = [];
	xData = ['便民服务', '公共服务', '行政服务']
	barData = [res.data.bianmin_num, res.data.gonggong_num, res.data.xingzheng_num];
	barChartFn(xData, barData)
});


//5.党建线上互动实时动态
ajaxData(rtdynamicUrl,function(res){
	var str = ''
	for(var i = 0;i<res.data.users.length;i++){
		var time = formatDateTime(res.data.users[i].last_time*1)
		str += '<li><span>'+res.data.users[i].nick_name+'</span><span>'+time+'</span></li>'
	}
	$('.section3-list').html(str);
	//党建线上互动实时动态-列表上下滚动
	
	$("#s3list2").myScroll({
		speed:60, 
		rowHeight:40
	});
});
//6.亦资街道基层党组织人力分布图
ajaxData(gridUrl,function(res){
	//console.log(res);
	
	pieChart1Fn(res.data.liudongrenkou);
	pieChart2Fn(res.data.liudongdangyuan);
	pieChart3Fn(res.data.shop);
	pieChart4Fn(res.data.zzmm);
	pieChart5Fn(res.data.kunnan);
	pieChart6Fn(res.data.daxue);
	pieChart7Fn(res.data.sex);
	pieChart8Fn(res.data.getjob);

	// 饼图轮播
	var n = 0;
	setInterval(function() {
		n++;
		$('.piechart-wrap').css({
			'transform': 'translateX(' + -13 * n + 'rem)'
		});
		if(n > 2) {
			n = 0;
		}
	}, 10000)
});

//7.智慧亦资服务量
ajaxData(channelUrl,function(res){
	var data = JSON.parse(res);
	// 折线图
	var xlineData = data.xaxis_data,
		linejobData = data.series_job,
		linetrainData = data.series_train,
		linehelpData = data.series_help;
		
		lineChartFn(xlineData, linejobData, linehelpData, linetrainData);
});

//8.贵州区域地图
ajaxData(mapUrl,function(res){
//	console.log(res);
	var mapData = [];

	var list = res.data.list

	for(var i = 0; i < list.length; i++) {
		mapData.push({
			name: list[i].name,
			jm_num: list[i].jm_num*1,
			ld_num: list[i].ld_num*1,
			dy_num: list[i].dy_num*1,
			lddy_num: list[i].lddy_num*1,
			cp_num: list[i].cp_num*1
		})
	}
	
	option = {
		series: [
			{
				type: 'map',
				mapType: 'guizhou',
				roam: false,
				nameMap: {
					'guizhou': '贵州'
				},
				zoom: 1.2,
				itemStyle: {
					normal: {
						areaColor: '#52b2fe',
						borderColor: '#6ad7ff'
					},
					emphasis: {
						areaColor: 'darkorange'
					}
				},
				data: mapData,
				zlevel: 0,
				tooltip: {
					trigger: 'item',
					padding: 10,
					formatter: function(params) {
						//console.log(params)
						return '[	' + params.name + '	]'
						+ '<br/>居民人数 ： ' + params.data.jm_num + ' 人' 
						+ '<br/>流动人口 ： ' + params.data.ld_num + ' 人'
						+ '<br/>党员总数 ： ' + params.data.dy_num + ' 人' 
						+ '<br/>流动党员 ： ' + params.data.lddy_num + ' 人'
						+ '<br/>非公党建单位数量 ： ' + params.data.cp_num + ' 个' 
					}
				},
			},
			{
				name: '用户坐标',
				type: 'scatter',
				coordinateSystem: 'geo',
				data: [{
					name: '亦资街道党工委',
					value: [104.474329, 25.708555, 100]
				}],
				tooltip: {
					trigger: 'item',
					formatter: '{b}'
				},
				symbol: 'image://data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAACyElEQVQ4T5WVX0hTcRTHv+fu7m7ebZHmn6E0UnwRIShfErZhL1H40osFRYpKQlhgRPVSBEEPJdFThFpiERVJsCLqfTMksN4FTfujTlPS5ubc3d2Je7e5u7uJ+Xv8ne/5/M45v/M7P0KRxU1NckyWzwA4CeAQgGpdRjQH5i/MHHCo6isaH98wu5N5I+r1doHoLoDyYocZ9sLMfN05NvbMqNsCcmOjFCsrGwTQsQMo30w0LFdV9dDoqKonkbVG/f6nYG7fFSwrJhp2BIPdW8BMmk+2hVkJliMu8JKC1GRB2XQ3Zu7Q0iduaXHGVHUWwL7tgFRuBUdUSH3VoD0iEvd+gtf0DI0rLCeTdRT1entANFAMZml2QbpYDSoVkXi4gOTHP7DfrwUkAfHL00CC89yYuYuifv8HMJ8wAzWY7YYHEAnqxDo2b30HkgzLQQds/bVQBsNQ3iyb3d5S1OdbAlBhtAgeG+yP6nWYXp9lBfGrM+D5hH6N8rtGpGbjiF+aNt/4nAbMjzsjsXZXQfDYwSsKxNayPGjJaAOQSGHj7KQ5Qt4WqCsF0q4PUl8NxOOlOjTxYA62OweQmtpAvNcUIaADFwFUGo8Sj5XqDqlv8fS2QJCu1UA8uhfQ8iFAGVmE8vK3OcJfGvA9gFajRSu6pUGGEliBGlwDryYh7LdBuukBlQi6NN47hdRU5sCcs34p5wFoTy4dTL0dtv46IKZC67+CIkVUkMsC9dNfbN7+kd82QGe2sWeyw4AqrZC63EgMLECotUNrH6qwgldVqBMRqJ8jsJ6qQDKwAo7mNXe6sbUjdnx6xbretMfAOWco9Dw3HHy+kV1Pmhz0sSMU0kqXmzbc1maJhcNDADr/IyCjZEh2uy8UjK+sYt3rbaf0gHXvAA4z0RVnMPjCqCuY2JqRm5tLoqJ4mtJfwOHMF6B14DyAr0wUcCjK62JfwD/IeBZykY1nKQAAAABJRU5ErkJggg==',
				symbolSize: 20,
			}
		]
	}
	mapChart.setOption(option)
	
});
//9.用户登录实时地图显示
ajaxData(mpdynamicUrl,function(res){
	//console.log(res)
});



// ajax
function ajaxData(url,callback){
	$.ajax({
		type:"get",
		url:url,
		success:function(res){
			callback(res)
		}
	});
}

// 时间格式化
function formatDateTime(inputTime) {
	var date = new Date(inputTime);
	var y = date.getFullYear();
	var m = date.getMonth() + 1;
	m = m < 10 ? ('0' + m) : m;
	var d = date.getDate();
	d = d < 10 ? ('0' + d) : d;
	var h = date.getHours();
	h = h < 10 ? ('0' + h) : h;
	var minute = date.getMinutes();
	var second = date.getSeconds();
	minute = minute < 10 ? ('0' + minute) : minute;
	second = second < 10 ? ('0' + second) : second;
	return y + '-' + m + '-' + d + ' ' + h + ':' + minute + ':' + second;
}

// 柱状图
// 基于准备好的dom，初始化echarts实例
var barChart = echarts.init(document.getElementById('barchart'));

function barChartFn(xData, barData) {
	var barOption = {
		color: ['#3398DB'],
		tooltip: {
			trigger: 'axis',
			axisPointer: { // 坐标轴指示器，坐标轴触发有效
				type: 'shadow' // 默认为直线，可选为：'line' | 'shadow'
			}
		},
		grid: {
			top: '10%',
			left: '0',
			right: '0',
			bottom: '0',
			containLabel: true
		},
		xAxis: [{
			type: 'category',
			axisLine: {
				lineStyle: {
					color: '#130C44'
				}
			},

			axisTick: {
				show: false,
				alignWithLabel: true
			},
			axisLabel: {
				color: '#fff',
			},
			data: xData,

		}],
		yAxis: [{
			type: 'value',
			axisLabel: {
				color: '#fff',
			},
			axisLine: {
				lineStyle: {
					color: '#130C44'
				}
			},
			splitLine: {
				lineStyle: {
					color: '#130C44'
				}
			},
		}],
		series: [{
			name: '服务数量',
			type: 'bar',
			barMaxWidth: '10',
			itemStyle: {
				normal: {
					color: new echarts.graphic.LinearGradient(
						0, 0, 0, 1, [{
								offset: 0,
								color: '#C308CB'
							},
							{
								offset: 1,
								color: '#7704D1'
							}
						]
					)
				},
			},
			data: barData
		}]
	};

	barChart.setOption(barOption);
}
				
// 折线图函数
function lineChartFn(xlineData, linejobData, linehelpData, linetrainData) {
	var lineChart = echarts.init(document.getElementById('linechart'));
	var lineOption = {
		color: ['#DD5858', '#00B37A', '#D79D4B', '#40B3E2'],
		tooltip: {
			trigger: 'axis'
		},
		legend: {
			top: 3,
			textStyle: {
				color: '#fff',
			},
			data: ['党群E家', '阳光政务', '诚信之家']
		},
		grid: {
			top: '10%',
			left: '5%',
			right: '0',
			bottom: '0',
			containLabel: true
		},
		xAxis: [{
			type: 'category',
			axisLine: {
				lineStyle: {
					color: '#130C44'
				}
			},

			axisTick: {
				show: false,
				alignWithLabel: true
			},
			axisLabel: {
				color: '#fff',
				rotate: 50,
			},

			data: xlineData

		}],

		yAxis: {
			type: 'value',
			axisLabel: {
				color: '#fff',
			},
			axisLine: {
				lineStyle: {
					color: '#130C44'
				}
			},
			splitLine: {
				lineStyle: {
					color: '#130C44'
				}
			},

		},
		series: [{
				name: '党群E家',
				type: 'line',
				data: linejobData
			},
			{
				name: '阳光政务',
				type: 'line',
				data: linehelpData
			},
			{
				name: '诚信之家',
				type: 'line',
				data: linetrainData
			}

		]
	};

	lineChart.setOption(lineOption);
}

// 贵州区域地图
// 绘制贵州地图
//mapFn()
var mapChart = echarts.init(document.getElementById('mapchart'));
$.getJSON('./static/js/guizhou.json', function(data) {
	//注册地图
	echarts.registerMap('guizhou', data);
	mapChart.setOption(option = {
		backgroundColor: '#0C0026',
		tooltip: {
			trigger: 'item',
			padding: 10,
			formatter: function(params) {
			}
		},
		geo: {
			map: 'guizhou',
			label: {
				emphasis: {
					show: true,
					textStyle: {
						color: '#fff'
					}
				}
			},
			zoom: 1.2,
			roam: false,
		},

	})
})


// 数字滚动增加特效
function updateNum(oldNum, newNum) {
	//console.log(oldNum, newNum)
	// 将数字转为字符串
	var oldNum = oldNum.toString();
	var newNum = newNum.toString();

	numberHTML = '';
	for(var i = newNum.length - 1; i >= 0; i--) {
		if(oldNum[i] !== newNum[i]) {
			if(oldNum[i] == undefined || oldNum[i] == null || oldNum[i] == "") {
				if(newNum[i] != ",")
					numberHTML = "<li class=\"group active\">" +
					"<span class=\"old\">0</span>" +
					"<span class=\"new\">" + newNum[i] + "</span></li>" + numberHTML;
				else
					numberHTML = "<li class=\"group active\">" +
					"<span class=\"old\">,</span>" +
					"<span class=\"new\">" + newNum[i] + "</span></li>" + numberHTML;
			} else
				numberHTML = "<li class=\"group active\">" +
				"<span class=\"old\">" + oldNum[i] + "</span>" +
				"<span class=\"new\">" + newNum[i] + "</span></li>" + numberHTML;
		} else {
			numberHTML = "<li class=\"group\">" +
				"<span class=\"old\">" + oldNum[i] + "</span>" +
				"<span class=\"new\">" + newNum[i] + "</span></li>" + numberHTML;
		}

	}
	return numberHTML;
}

// 时间
// 获取本地时间
function timeFn() {
	var nowdate = new Date();
	var y = nowdate.getFullYear();
	var m = nowdate.getMonth() + 1;
	var d = nowdate.getDate();
	var h = nowdate.getHours();
	var minutes = nowdate.getMinutes();
	var s = nowdate.getSeconds();
	m = m < 10 ? '0' + m : m;
	d = d < 10 ? '0' + d : d;
	h = h < 10 ? '0' + h : h;
	minutes = minutes < 10 ? '0' + minutes : minutes;
	s = s < 10 ? '0' + s : s;
	var nowTime = y + '年' + m + '月' + d + '日&nbsp;&nbsp;' + h + ':' + minutes + ':' + s;
	$('.date').html(nowTime)
}

timeFn();

setInterval(function() {
	timeFn()
}, 1000)

// 圆环图
// 流动人口
function pieChart1Fn(obj) {
	var pieChart1 = echarts.init(document.getElementById('piechart1'));
	var pieOption1 = {
		color: ['#FFB50A', '#8C04FA', '#10BD8F', '#0DB7DB'],
		legend: {
			bottom: '0',
			itemWidth: 10,
			itemHeight: 10,
			borderRadius: 10,
			padding: [10, 30],
			textStyle: {
				color: '#fff',
			},
			data: ['流动','辖区']
		},
		tooltip:{
			 trigger: 'item',
        	formatter: "{a} <br/>{b}: {d}%"
		},
		series: [{
			name: '流动人口',
			type: 'pie',
			radius: ['40%', '55%'],
			center: ['50%', '40%'],
			avoidLabelOverlap: false,
			label: {
				normal: {
					position: 'outside',
					formatter: '{d}%',
					color: '#fff',
				},
			},
			labelLine: {
				normal: {
					length: 0,
					length2: 15,
					lineStyle: {
						color: '#fff',
					},
				}
			},
			data: [
				{value: obj['liudong'],name: '流动'},
				{value: obj['xiaqu'],name: '辖区'}
			]
		}]
	}
	pieChart1.setOption(pieOption1);
}

// 流动党员
function pieChart2Fn(obj) {
	var pieChart2 = echarts.init(document.getElementById('piechart2'));
	var pieOption2 = {
		color: ['#FFB50A', '#8C04FA', '#10BD8F', '#10BD8F', '#0DB7DB'],
		legend: {
			bottom: '0',
			itemWidth: 10,
			itemHeight: 10,
			borderRadius: 10,
			padding: [10, 20],
			textStyle: {
				color: '#fff',
			},
			data: ['流动', '辖区']
		},
		tooltip:{
			 trigger: 'item',
        	formatter: "{a} <br/>{b}: {d}%"
		},
		series: [{
			name: '流动党员',
			type: 'pie',
			radius: ['40%', '55%'],
			center: ['50%', '40%'],
			label: {
				normal: {
					//show: false,
					position: 'outside',
					formatter: '{d}%',
					color: '#fff',

				},
			},
			minAngle: 20,
			labelLine: {
				normal: {
					length: 0,
					length2: 15,
					lineStyle: {
						color: '#fff',
					},
				}
			},
			data: [
				{value: obj['liudong'],name: '流动'},
				{value: obj['xiaqu'],name: '辖区'}
			]
		}]
	}
	
	
	pieChart2.setOption(pieOption2);
}

// 店铺
function pieChart3Fn(obj) {
	var pieChart3 = echarts.init(document.getElementById('piechart3'));
	var pieOption3 = {
		color: ['#FFB50A', '#8C04FA', '#10BD8F', '#10BD8F', '#0DB7DB'],
		legend: {
			bottom: '0',
			itemWidth: 10,
			itemHeight: 10,
			borderRadius: 10,
			padding: [10, 20],
			textStyle: {
				color: '#fff',
			},
			data: ['诚信','党员']
		},
		tooltip:{
			 trigger: 'item',
        	formatter: "{a} <br/>{b}: {d}%"
		},
		series: [{
			name: '店铺',
			type: 'pie',
			radius: ['40%', '55%'],
			center: ['50%', '40%'],
			label: {
				normal: {
					position: 'outside',
					formatter: '{d}%',
					color: '#fff',

				},
			},
			labelLine: {
				normal: {
					length: 0,
					length2: 15,
					lineStyle: {
						color: '#fff',
					},
				}
			},
			minAngle: 20,
			data: [{
					value: obj['chengxin'],
					name: '诚信'
				},
				{
					value: obj['dangyuan'],
					name: '党员'
				}
			]
		}]
	}
	pieChart3.setOption(pieOption3);
}

// 政治面貌
function pieChart4Fn(obj) {
	var pieChart4 = echarts.init(document.getElementById('piechart4'));
	var pieOption4 = {
		color: ['#FFB50A', '#8C04FA', '#10BD8F', '#10BD8F', '#0DB7DB'],
		legend: {
			bottom: '0',
			itemWidth: 10,
			itemHeight: 10,
			borderRadius: 10,
			padding: [10, 20],
			textStyle: {
				color: '#fff',
			},
			data: ['党员', '其他党派', '无党派']
		},
		tooltip:{
			 trigger: 'item',
        	formatter: "{a} <br/>{b}: {d}%"
		},
		series: [{
			name: '政治面貌',
			type: 'pie',
			radius: ['40%', '55%'],
			center: ['50%', '40%'],
			label: {
				normal: {
					//show: false,
					position: 'outside',
					formatter: '{d}%',
					color: '#fff',

				},
			},
			labelLine: {
				normal: {
					length: 0,
					length2: 15,
					lineStyle: {
						color: '#fff',
					},
				}
			},
			minAngle: 20,
			data: [{
					value: obj["dangyuan"],
					name: '党员'
				},
				{
					value: obj["qitadang"],
					name: '其他党派'
				},
				{
					value: obj["wudangpai"],
					name: '无党派'
				},

			]
		}]
	}
	pieChart4.setOption(pieOption4);
}

// 困难人员
function pieChart5Fn(obj) {
	var pieChart5 = echarts.init(document.getElementById('piechart5'));
	var pieOption5 = {
		color: ['#FFB50A', '#8C04FA', '#10BD8F', '#10BD8F', '#0DB7DB'],
		legend: {
			bottom: '0',
			itemWidth: 10,
			itemHeight: 10,
			borderRadius: 10,
			padding: [10, 20],
			textStyle: {
				color: '#fff',
			},
			data: ['4050', '低保','零就业']
		},
		tooltip:{
			 trigger: 'item',
        	formatter: "{a} <br/>{b}: {d}%"
		},
		series: [{
			name: '困难人员',
			type: 'pie',
			radius: ['40%', '55%'],
			center: ['50%', '40%'],
			label: {
				position: 'outside',
				formatter: '{d}%',
				color: '#fff',
				align: 'left',
				verticalAlign: 'bottom'
			},
			itemStyle: {
				emphasis: {
					shadowBlur: 10,
					shadowOffsetX: 0,
					shadowColor: 'rgba(0, 0, 0, 0.5)'
				}
			},
			labelLine: {
				normal: {
					length: 0,
					length2: 15,
					lineStyle: {
						color: '#fff',
					},
				}
			},
			minAngle: 20,
			data: [
				{value: obj["4050"],name: '4050'},
				{value: obj["dibao"],name: '低保'},
				{value: obj["lingjiuye"],name: '零就业'},
			]
		}]
	}
	pieChart5.setOption(pieOption5);
}

// 大学生
function pieChart6Fn(obj) {
	var pieChart6 = echarts.init(document.getElementById('piechart6'));
	var pieOption6 = {
		color: ['#FFB50A', '#8C04FA', '#10BD8F', '#10BD8F', '#0DB7DB'],
		legend: {
			bottom: '0',
			itemWidth: 10,
			itemHeight: 10,
			borderRadius: 10,
			padding: [10, 20],
			textStyle: {
				color: '#fff',
			},
			data: ['男', '女']
		},
		tooltip:{
			 trigger: 'item',
        	formatter: "{a} <br/>{b}: {d}%"
		},
		series: [{
			name: '大学生',
			type: 'pie',
			radius: ['40%', '55%'],
			center: ['50%', '40%'],
			label: {
				position: 'outside',
				formatter: '{d}%',
				color: '#fff',
				align: 'left',
				verticalAlign: 'bottom'
			},
			labelLine: {
				normal: {
					length: 0,
					length2: 15,
					lineStyle: {
						color: '#fff',
					},
				}
			},
			minAngle: 20,
			data: [
				{value: obj["nan"],name: '男'},
				{value: obj["nv"],name: '女'},
			]
		}]
	}
	pieChart6.setOption(pieOption6);
}

// 性别
function pieChart7Fn(obj) {
	var pieChart7 = echarts.init(document.getElementById('piechart7'));
	var pieOption7 = {
		color: ['#FFB50A', '#8C04FA', '#10BD8F', '#10BD8F', '#0DB7DB'],
		legend: {
			bottom: '0',
			itemWidth: 10,
			itemHeight: 10,
			borderRadius: 10,
			padding: [10, 20],
			textStyle: {
				color: '#fff',
			},
			data: ['男', '女']
		},
		tooltip:{
			 trigger: 'item',
        	formatter: "{a} <br/>{b}: {d}%"
		},
		series: [{
			name: '性别',
			type: 'pie',
			radius: ['40%', '55%'],
			center: ['50%', '40%'],
			label: {
				position: 'outside',
				formatter: '{d}%',
				color: '#fff',
				align: 'left',
				verticalAlign: 'bottom'
			},
			labelLine: {
				normal: {
					length: 0,
					length2: 15,
					lineStyle: {
						color: '#fff',
					},
				}
			},
			minAngle: 20,
			data: [{
					value: obj["nan"],
					name: '男'
				},
				{
					value: obj["nv"],
					name: '女'
				},
			]
		}]
	}
	pieChart7.setOption(pieOption7);
}

// 就业
function pieChart8Fn(obj) {
	var pieChart8 = echarts.init(document.getElementById('piechart8'));
	var pieOption8 = {
		color: ['#FFB50A', '#8C04FA', '#10BD8F', '#10BD8F', '#0DB7DB'],
		legend: {
			bottom: '0',
			itemWidth: 10,
			itemHeight: 10,
			borderRadius: 10,
			padding: [10, 20],
			textStyle: {
				color: '#fff',
			},
			data: ['失业', '就业']
		},
		tooltip:{
			 trigger: 'item',
        	formatter: "{a} <br/>{b}: {d}%"
		},
		series: [{
			name: '就业',
			type: 'pie',
			radius: ['40%', '55%'],
			center: ['50%', '40%'],
			label: {
				position: 'outside',
				formatter: '{d}%',
				color: '#fff',
				align: 'left',
				verticalAlign: 'bottom'
			},
			labelLine: {
				normal: {
					length: 0,
					length2: 15,
					lineStyle: {
						color: '#fff',
					},
				}
			},
			minAngle: 20,
			data: [{
					value: obj["shiye"],
					name: '失业'
				},
				{
					value: obj["jiuye"],
					name: '就业'
				},
			]
		}]
	}
	pieChart8.setOption(pieOption8);
}
</script>
</body>
</html>